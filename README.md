# Towards Deeper Understanding of PPR-based Embedding Approaches: A Topological Perspective (PPREI)

This is our Pytorch implementation for the paper:

> Xingyi Zhang, Zixuan Weng, Sibo Wang (2024). Towards Deeper Understanding of PPR-based Embedding Approaches: A Topological Perspective." In WWW 2024.

## Introduction
Node embedding learns a low-dimensional vectors for each node in the graph. Recent state-of-the-art node embedding approaches take {\em Personalized PageRank (PPR)} 
as the proximity measure and factorize the PPR matrix or its adaptation to generate embedding vectors. However, little previous work analyzes what information is encoded by these approaches,
and how the information correlates with their superb performance in downstream tasks. In this work, we first show that the state-of-the-art embedding approaches that factorize a
PPR-related matrix can be unified into a closed-form framework. Then, we study whether the embeddings generated by such a strategy can be inverted to better recover the graph topology 
information than random-walk based embeddings. To achieve this, we propose two methods for 
recovering graph topology via PPR-based embeddings, including the analytical method and the optimization method. 
Extensive experimental results demonstrate that the embeddings generated by factorizing a PPR-related matrix maintain more topological information, 
such as common edges and community structures, than that generated by random walks, paving a new way to systematically comprehend why PPR-based node embedding approaches outperform
random walk-based alternatives in various downstream tasks. To the best of our knowledge, this is the first work that focuses on the interpretability of PPR-based node embedding approaches.

## Requirements:
* Python=3.10.12
* PyTorch=1.12.0
* Scipy=1.10.1
* networkx=2.8.4
* numpy=1.24.3
## Preprocessing the dataset:
run processData
```
python processData.py -f Brazil
```
## Training:
run PPR
```
python  PPR.py -f Brazil.mat -r 128 -a 0.7 -i 40 -t 10 -e 1e-7
```

run network_stats_PPR
```
python network_stats_PPR.py -f Brazil.mat -r 128
```
## Acknowledgements:
Most codes are from https://github.com/konsotirop/Invert_Embeddings, which is the official implementation of the paper:
        DeepWalking Backwards: From Embeddings Back to Graphs
        Sudhanshu Chanpuriya, Cameron Musco, Konstantinos Sotiropoulos, Charalampos E. Tsourakakis
## Reference:
Any scientific publications that use our codes should cite the following paper as the reference:

```
 @inproceedings{zhang&weng2024PPREI,
     title = "Towards Deeper Understanding of PPR-based Embedding Approaches: A Topological Perspective",
     author = {Xingyi Zhang and
     		  Zixuan Weng and
     		  Sibo wang},
     booktitle = {{WWW}},
     year = {2024},
 }
 ```

If you have any questions for our paper or codes, please send an email to zxweng0701@gmail.com.
